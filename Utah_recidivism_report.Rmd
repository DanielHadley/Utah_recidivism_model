---
title: "The Costs and Benefits of Reducing Recidivsm in Utah"
output: 
    word_document:
      reference_docx: mystyles.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load the packages neeed and set working directory
setwd("~/Github/Utah_recidivism_model/")
library(tidyverse)
library(printr)
library(knitr)
library(scales)

# Notice that I have a reference doc, mystyles. I used this to create a page break after H5 tags, per this doc: 
# scriptsandstatistics.wordpress.com/2015/12/18/rmarkdown-how-to-inserts-page-breaks-in-a-ms-word-document/
```



This report describes work done by staff at the [Sorenson Impact Center](http://eccles.utah.edu/sorenson-impact-center/) of the University of Utah to quantify the costs and benefits of a program to reduce recidivism among parolees with a dual diagnosis. The state of Utah has taken several principled actions to reduce recidivism and better address the needs of former prisoners, most notably the Justice Reinvestment Initiative (JRI). The program under consideration continues in that tradition by proposing to offer intensive case work services to parolees with co-occurring disorders (COD). The expectation is that these efforts will reduce recidivism, as they have in previous experiments. 

The potential benefits of reducing jail time for the COD population are numerous. In this report, we focus mainly on the economic benefits that accrue to the state of Utah, paying particular attention to prison costs. Data from the Utah Department of Corrections demonstrate that the average prisoner costs the State $81.34 per day, or approximately $30,000 per year. 

The challenge is determining how much time the average person from the COD demographic is expected to spend in prison, once released, and what reducing that is likely to save the State. This is a difficult prediction problem, given all of the factors; but we have created a model that does a reasonable job of simulating a person's chances of returning to prison. With that information, we can scale up - that is, simulate a thousand people and collect statistics on the outcome. The assumptions, challenges, and conclusions of this approach are described in the following pages. 

As the statistician George Box [famously observed](https://en.wikipedia.org/wiki/All_models_are_wrong), "all models are wrong but some are useful." We hope this one is useful. 

![](dont_commit/logo.png)


##### Pagebreak

```{r recidivism rates, include=FALSE}
# A 10% reduction in recidivism 
recid_reduction_JRI <- .10

## Load and clean the data ##
# These are the national data
survival_rates <- read.csv("./clean_data/mschpprts05f02.csv", 
                           stringsAsFactors = F) %>% 
  filter(X != "",
         X != "National") %>% 
  mutate(In.state = as.numeric(X.1),
         cumulative_percent = In.state / 100,
         cumulative_prob_did_not = 1 - cumulative_percent,
         prob_recidivate = 1 - cumulative_prob_did_not / lag(cumulative_prob_did_not)) %>% filter(In.state != 0)


# Here are imputed survival rates. Basically, the data that Julie sent suggest that the national trends for recidivism are very similar to the Utah trends (or at least they were between 2012 and 2015).
# The data also show that our study group had a recidivsm rate that was 74.3% after 36 months, whereas all prisoners had a rate of 64.2% (again, close to natural). The difference between the control group and national trends is (74.3 - 64.2) / 64.2, OR:
COD_group_increase = 0.157

sr_study_group <- read.csv("./clean_data/mschpprts05f02.csv", 
                                 stringsAsFactors = F) %>% 
  filter(X != "",
         X != "National") %>% 
  mutate(In.state = as.numeric(X.1),
         In.state = In.state + (In.state * COD_group_increase)) %>% 
  mutate(cumulative_percent = In.state / 100,
         cumulative_prob_did_not = 1 - cumulative_percent,
         prob_recidivate = 1 - cumulative_prob_did_not / lag(cumulative_prob_did_not)) %>% filter(In.state != 0)


# Let's see what will happen post JRI
COD_group_increase = 0.157

sr_post_intervention <- read.csv("./clean_data/mschpprts05f02.csv", 
                           stringsAsFactors = F) %>% 
  filter(X != "",
         X != "National") %>% 
  mutate(In.state_pre = as.numeric(X.1),
         In.state_pre = In.state_pre + (In.state_pre * COD_group_increase),
         In.state = In.state_pre - (In.state_pre * recid_reduction_JRI)) %>% 
  mutate(cumulative_percent = In.state / 100,
         cumulative_prob_did_not = 1 - cumulative_percent,
         prob_recidivate = 1 - cumulative_prob_did_not / lag(cumulative_prob_did_not)) %>% filter(In.state != 0)

sr_post_intervention$cum_per_of_reoffenders <- sr_post_intervention$In.state / sr_post_intervention$In.state[60]



# Put them together to plot

all_together <- data.frame(sr_post_intervention$cumulative_percent, sr_study_group$cumulative_percent, survival_rates$cumulative_percent)

all_together$months <- c(1:60)
```


# Recidivism Rates

## Description:
This is the estimated percent of parolees who will return to prison within a given time after release. 


## Sources:
The kaplan-meier curves come from this [BJS Report](http://www.bjs.gov/index.cfm?ty=pbdetail&iid=4986) of national trends. The Utah Department of Corrections also provided recidivism rates for the 2012 release cohort, which allowed for tracking of the COD population over three years. I do not have data showing the exact Utah curves (nor does such data exist for the post-JRI era), but I was encouraged to learn that the 3-year outcomes for Utah pre-JRI were very similar to national trends. 


## Assumptions:
* The survival curves for the COD population will bend in similar ways to national trends
* The JRI will reduce recidivism among the COD population by `r percent(recid_reduction_JRI)`.


## Statistics
* Pre-JRI, approximately `r percent(round(sr_study_group$cumulative_percent[12], 2))` of the COD population re-offended within one year.
* Approximately `r percent(round(sr_study_group$cumulative_percent[36], 2))` re-offended within three years.
* If, as this model assumes, the JRI reduces recidivism by `r percent(recid_reduction_JRI)`, there will still be `r percent(round(sr_post_intervention$cumulative_percent[36], 2))` of the COD population who recidivate within three years.


##### Pagebreak
The following chart shows estimated survival curves from national averages, the COD population pre-JRI, and post-JRI with a `r percent(recid_reduction_JRI)` reduction in recidivism. The X-axis is time in months over a period of five years. The Y-axis is the cumulative percent who recidivate at least once. The chart shows that recidivism is more likely in the first year, and then tapers off over time. This suggests that if a program is effective at helping people early on, it will be more effective than if it aims to help people several months removed from their release.   

```{r pressure, echo=FALSE}
# plot the curves
ggplot(all_together, aes(months)) + 
  geom_line(aes(y = sr_post_intervention.cumulative_percent, colour = "COD Post-JRI")) + 
  geom_line(aes(y = sr_study_group.cumulative_percent, colour = "COD Group")) +
  geom_line(aes(y = survival_rates.cumulative_percent, colour = "National Trend")) +
  ylab("Percent Who Recidivate") +
  scale_y_continuous(labels=percent)

# And clean things up
rm(all_together, sr_post_intervention, sr_study_group, survival_rates)
```


##### Pagebreak

```{r, echo=FALSE}
prison_terms <- read.csv("./clean_data/prison_terms.csv", stringsAsFactors = FALSE) %>% 
  mutate(mean_time_served = round(mean_time_served)) %>% 
  select(-assumptions)

# I do these so that I can add a blank in the function below
prison_terms[8,1] <- ""

# replcace NAs with 0
prison_terms$frequency[is.na(prison_terms$frequency)] <- 0
prison_terms$frequency_of_crime[is.na(prison_terms$frequency_of_crime)] <- 0

```


# Crime Types

## Description:
These data show the frequency of certain crime types among parolees. They differ from the survival curves in that they show not the time it takes to reoffend, but what type of crime is most likely to be involved in the event of a reoffense.  


## Sources:
I pieced this data together using a an email from Julie Christensen, which contained the offense frequencies for our COD demographic, and various reports from the CCJJ. For the "frequency" column, I took the `frequency_of_crime` and added parole violations, which used to account for 70% of returns. In the model, `frequency` is used when the person is on parole, and `frequency_of_crime` is used when they are not.    


## Assumptions:
* The crime type frequencies for a reoffense will be similar to those from the original offense with one major difference: the reoffense frequencies will include parole violations, which are very common.   


## Statistics
* Property crimes are the most likely type of crime, at `r percent(round(prison_terms$frequency_of_crime[prison_terms$offense_type == "Property"], 2))` of all crimes commited while off parole.
* Murder is the least likely, at `r percent(round(prison_terms$frequency_of_crime[prison_terms$offense_type == "Murder"], 2))`
* When on parole, the most likely reason to be sent back is for a technical violation. These account for about `r percent(round(prison_terms$frequency[prison_terms$offense_type == "Parole_Violation"], 2))` of recidivism occurances. 

The following table shows these frequencies.

```{r, echo=FALSE}

frequenceis_to_print <- prison_terms %>% 
  select(offense_type, frequency_of_crime, frequency) %>% 
  filter(offense_type != "") %>% 
  mutate(frequency_of_crime = percent(frequency_of_crime),
         frequency = percent(frequency))

kable(head(frequenceis_to_print, 10), digits = 3)

rm(frequenceis_to_print)
```



##### Pagebreak

```{r, echo=FALSE}

# This is just a guess
time_served_scale_JRI <- .8

# Scale down time served to reflect (guess)timated effects of the JRI
prison_terms$mean_time_served_post_JRI <- round(prison_terms$mean_time_served * time_served_scale_JRI)


# Another big change from the JRI is that prison sentences for technical violations are capped
# So we change the 15-month mean time served to a 2-month one
# page 39: http://www.utah.gov/pmn/files/172049.pdf
parole_violation_MTS_JRI <- 2

# Change parole violation sentences to post-JRI level
prison_terms$mean_time_served_post_JRI[prison_terms$offense_type == "Parole_Violation"] <- parole_violation_MTS_JRI

# Finally, the length of parole is expected to go down significantly
# AS far as I can tell, 3 years was standard for all offenders. 
# http://law.justia.com/codes/utah/2006/title76/76_03009.html
# With the JRI, parolees with good behavior can reduce that to 18 months
parole_length_JRI <- 18

```


# Prison Time Served

## Description:
If convicted, these data show the length of time a parolee can expect to spend in prison, on average, for the various crime types. 


## Sources:
The [Justice Reinvestment Report](http://justice.utah.gov/Documents/CCJJ/Reports/Justice_Reinvestment_Report_2014.pdf) and [ACLU Report](http://www.acluutah.org/criminal-justice/item/download/15_0cfccf37c91e9fb16be4ac2e89ca12f2) contain the mean time served for various offenses, which I scale down to reflect changes from the JRI (as described below). 


## Assumptions:
* The JRI will reduce the mean prison time served by about `r percent(1 - time_served_scale_JRI)` for all crime types. This is just a guess as there are not enough empirical datapoints to confirm what the JRI will do to time served, but it is almost certain that sentences will be reduced. 
* The average prison sentence for technical violations will go from 15 months to approximately `r parole_violation_MTS_JRI`. This is also a guess based on the new [sentencing guidelines](http://www.utah.gov/pmn/files/172049.pdf).
* The average parole sentence will go from three years to `r parole_length_JRI <- 18` months for those who exhibit good behavior, as per [this](http://law.justia.com/codes/utah/2006/title76/76_03009.html) document. 


## Statistics
* Prior to the JRI, murder resulted in the longest average prison sentence at `r prison_terms$mean_time_served[prison_terms$offense_type == "Murder"]` months.
* The second longest was for sex crimes: `r prison_terms$mean_time_served[prison_terms$offense_type == "sex"]` months.

Here is a table of the actual values and the estimated values for the post-JRI period.

```{r, echo=FALSE}

mts_to_print <- prison_terms %>% 
  select(offense_type, mean_time_served, mean_time_served_post_JRI) %>% 
  filter(offense_type != "") 

kable(head(mts_to_print, 10), digits = 3)

rm(mts_to_print)

```
